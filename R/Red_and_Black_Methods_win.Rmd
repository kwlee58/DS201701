---
title: "Red and Black (Randomization) : Stat Methods"
author: "coop711"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# install.packages("xlsx", repos = "https://cran.rstudio.com")
library(xlsx)
library(knitr)
```

### Data

```{r, data, echo = TRUE, results = 'markup'}
# class_roll <- read.xlsx("../data/class_roll.xlsx", 1, startRow = 2, endRow = 23, colIndex = c(3:7, 9), colClasses = rep("character", 6), stringsAsFactors = FALSE)
load("./team_1602_data_win.rda")
str(class_roll)
names(class_roll) <- c("dept", "id", "name", "year", "e.mail", "cell.no")
str(class_roll)
kable(class_roll)
```

### Randomization

```{r, randomization, echo = TRUE}
set.seed(2)
N <- nrow(class_roll)
group <- 1 + sample(1:N) %% 2
class_roll$group <- factor(group, levels = 1:2, labels = c("Red", "Black"))
kable(class_roll)
```

### ?Ð¹?

```{r, id, echo = TRUE}
# ID.14 <- factor(ifelse(substr(class_roll$id, 1, 4) >= 2014, "younger.14", "older.14"), levels=c("younger.14", "older.14"), labels = c("14?Ð¹? ????", "13?Ð¹? ????"))
# kable(table("?×·?" = class_roll$group, "14?Ð¹? ????" = ID.14))
ID.13 <- factor(ifelse(substr(class_roll$id, 1, 4) >= 2013, "younger.13", "older.13"), levels=c("younger.13", "older.13"), labels = c("13?Ð¹? ????", "12?Ð¹? ????"))
kable(table("?×·?" = class_roll$group, "13?Ð¹? ????" = ID.13))
ID.12 <- factor(ifelse(substr(class_roll$id, 1, 4) >= 2012, "younger.12", "older.12"), levels=c("younger.12", "older.12"), labels = c("12?Ð¹? ????", "11?Ð¹? ????"))
kable(table("?×·?" = class_roll$group, "12?Ð¹? ????" = ID.12))
```

### ?Ð¹? ???Ú¸? È¦Â¦

```{r, odd or even, echo = TRUE}
odd.even <- factor(as.numeric(class_roll$id) %% 2, levels = c(1, 0), labels = c("È¦", "Â¦"))
kable(table("?×·?"= class_roll$group, "È¦Â¦" = odd.even))
```

### ?Ð³? ????

```{r, School Year, echo = TRUE}
kable(table("?×·?"= class_roll$group, "?Ð³?" = class_roll$year))
```

### e-mail ?????? ??Ã¼

```{r, e_mail, echo = TRUE}
e.mail.list <- strsplit(class_roll$e.mail, "@", fixed = TRUE)
mail.com <- mapply("[", e.mail.list, 2)
mail.com.f <- factor(ifelse(mail.com == "naver.com", mail.com, "??Å¸ ???ñ½º¾?Ã¼"), levels = c("naver.com", "??Å¸ ???ñ½º¾?Ã¼"))
kable(table("?×·?" = class_roll$group, "e-mail" = mail.com.f))
```

### ???? ????

```{r, name, echo = TRUE}
f.name <- substring(class_roll$name, first = 1, last = 1)
kable(table("?×·?" = class_roll$group, "????" = f.name))
```

#### ???? ???ï¿½ï¿½? ????

```{r, frequent family name, echo = TRUE}
f.name <- substring(class_roll$name, first = 1, last = 1)
# f.name %in% c("??","??","??")
f.name.f <- factor(ifelse(f.name %in% c("??", "??", "??", "??"), f.name, "??Å¸"), levels = c("??", "??", "??", "??", "??Å¸"))
kable(table("Group" = class_roll$group, "Family Name" = f.name.f))
```


### ?Ð°? ????

```{r, big departments, echo = TRUE, results = 'markup'}
(tbl.dept <- table(class_roll$dept))
kable(t(as.table(tbl.dept)))
str(tbl.dept)
dept.big <- names(tbl.dept)[tbl.dept >= 8]
dept.major <- ifelse(class_roll$dept %in% dept.big, class_roll$dept, "??Å¸ ?Ð°?")
dept.major.f <- factor(dept.major, levels = c(dept.big, "??Å¸ ?Ð°?"))
kable((table("?×·?" = class_roll$group, "?Ð°?" = class_roll$dept)))
```

```{r, departments, echo = TRUE}
kable(table("?×·?" = class_roll$group, "?Ð°?" = dept.major.f))
```

<<<<<<< HEAD
### ?â¼®??

```{r, class roll, echo = FALSE}
kable(class_roll)
```

### Red and Black ??????
=======
### Red and Black ³ª´©±â
>>>>>>> 3170601b24b9857709c48c1cdbbf797ddd6e7071

```{r, list, echo = TRUE, results = 'hide'}
(gr.id.o <- order(class_roll$group, class_roll$name))
(id.by.gr <- class_roll[gr.id.o, c("group", "id", "name")])
(red.names <- id.by.gr[id.by.gr$group == "Red", c("id", "name")])
(black.names <- id.by.gr[id.by.gr$group == "Black", c("id", "name")])
```

<P style="page-break-before:always">

```{r, red.names, echo = TRUE}
kable(red.names, caption = "Red")
```

<P style="page-break-before:always">

```{r, black.names, echo = TRUE}
kable(black.names, caption = "Black")
```

<!--
```{r, save}
save.image("./red_and_black_16_data.rda")
```
-->
